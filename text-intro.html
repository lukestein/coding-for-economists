
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>1. Introduction to Text &#8212; Coding for Economists</title>
    
  <link rel="stylesheet" href="_static/css/index.f658d18f9b420779cfdf24aa0a7e2d77.css">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/sphinx-book-theme.40e2e510f6b7d1648584402491bb10fe.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="_static/js/index.d3f166471bb80abb5163.js">

    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.d31b09fe5c1d09cb49b26a786de4a05d.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.0/dist/embed-amd.js"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <link rel="canonical" href="https://aeturrell.github.io/coding-for-economists/text-intro.html" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="2. Natural Language Processing" href="text-nlp.html" />
    <link rel="prev" title="3. Regression" href="econmt-regression.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />


<!-- Opengraph tags -->
<meta property="og:url"         content="https://aeturrell.github.io/coding-for-economists/text-intro.html" />
<meta property="og:type"        content="article" />
<meta property="og:title"       content="Introduction to Text" />
<meta property="og:description" content="Introduction to Text  This chapter covers how to use code to work with text as data, including opening files with text in, changing and cleaning text, regular e" />
<meta property="og:image"       content="https://aeturrell.github.io/coding-for-economists/_static/smith_lovelace.png" />

<meta name="twitter:card" content="summary" />


  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="index.html">
  
  <img src="_static/smith_lovelace.png" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">Coding for Economists</h1>
  
</a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="intro.html">
   Introduction
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Coding
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="code-preliminaries.html">
   1. Preliminaries
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="code-basics.html">
   2. Basics of Coding
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="code-advanced.html">
   3. Advanced Coding
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="code-where.html">
   4. Options for Writing Code
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Workflow
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="wrkflow-best-practice.html">
   1. Tips for Better Coding
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="wrkflow-advcd-best-practice.html">
   2. Tools for Better Coding
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="wrkflow-command-line.html">
   3. The Command Line
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Data
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="data-analysis-quickstart.html">
   1. Data Analysis Quickstart
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="data-intro.html">
   2. Working with Data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="data-exploratory-analysis.html">
   3. Exploratory Data Analysis
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="data-read-and-write.html">
   4. Reading and Writing Files
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="data-extraction.html">
   5. Extracting Data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="data-sharing.html">
   6. Sharing Data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="data-advanced.html">
   7. Advanced Data
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Data Visualisation
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="vis-intro.html">
   1. Intro to Data Visualisation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="vis-common-plots.html">
   2. Common Plots
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="vis-animation.html">
   3. Animation
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Econometrics
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="econmt-probability-random.html">
   1. Probability and Random Processes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="econmt-statistics.html">
   2. Statistics
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="econmt-regression.html">
   3. Regression
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Text Analysis
 </span>
</p>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   1. Introduction to Text
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="text-nlp.html">
   2. Natural Language Processing
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Geospatial
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="geo-intro.html">
   1. Intro to Geo-Spatial Analysis
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="geo-vis.html">
   2. Geo-Spatial Visualisation
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Mathematics with Code
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="maths-maths-coding.html">
   1. Intro to Mathematics with Code
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Automation
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="auto-research-outputs.html">
   1. Automating Research Outputs
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Coming from ...
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="coming-from-stata.html">
   Coming from Stata
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="coming-from-matlab.html">
   Coming from Matlab
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="coming-from-r.html">
   Coming from R
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="coming-from-excel.html">
   Coming from Excel
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Elsewhere
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="zreferences.html">
   Bibliography
  </a>
 </li>
</ul>

</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/text-intro.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

        <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/aeturrell/coding-for-economists"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/aeturrell/coding-for-economists/issues/new?title=Issue%20on%20page%20%2Ftext-intro.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/aeturrell/coding-for-economists/main?urlpath=tree/text-intro.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <a class="colab-button" href="https://colab.research.google.com/github/aeturrell/coding-for-economists/blob/main/text-intro.ipynb"><button type="button" class="btn btn-secondary topbarbtn"
                title="Launch Colab" data-toggle="tooltip" data-placement="left"><img class="colab-button-logo"
                    src="_static/images/logo_colab.png"
                    alt="Interact on Colab">Colab</button></a>
        
        
    </div>
</div>

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#an-aside-on-encodings">
   1.1. An aside on encodings
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#strings">
   1.2. Strings
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#f-strings">
     1.2.1. f-strings
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#special-characters">
     1.2.2. Special characters
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#cleaning-text">
   1.3. Cleaning Text
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#replacing-sub-strings">
     1.3.1. Replacing sub-strings
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#replacing-characters-with-translate">
     1.3.2. Replacing characters with translate
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#slugifying">
     1.3.3. Slugifying
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#splitting-strings">
     1.3.4. Splitting strings
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#count-and-find">
     1.3.5. count and find
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#regular-expressions">
   1.4. Regular expressions
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id2">
     1.4.1. Special Characters
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#quantifiers">
     1.4.2. Quantifiers
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#metacharacters">
     1.4.3. Metacharacters
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#ranges">
     1.4.4. Ranges
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#greedy-versus-lazy-regexes">
     1.4.5. Greedy versus lazy regexes
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#matches-versus-capture-groups">
     1.4.6. Matches versus capture groups
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#scaling-up-from-a-single-string-to-a-corpus">
   1.5. Scaling up from a single string to a corpus
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#reading-text-in">
   1.6. Reading Text In
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#text-file">
     1.6.1. Text file
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#csv-file">
     1.6.2. CSV file
    </a>
   </li>
  </ul>
 </li>
</ul>

        </nav>
        
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="introduction-to-text">
<span id="text-intro"></span><h1><span class="section-number">1. </span>Introduction to Text<a class="headerlink" href="#introduction-to-text" title="Permalink to this headline">¶</a></h1>
<p>This chapter covers how to use code to work with text as data, including opening files with text in, changing and cleaning text, regular expressions, and vectorised operations on text.</p>
<p>It has benefitted from the <a class="reference external" href="https://mkaz.blog/code/python-string-format-cookbook/">Python String Cook Book</a> and Jake VanderPlas’ <a class="reference external" href="https://jakevdp.github.io/PythonDataScienceHandbook/03.10-working-with-strings.html">Python Data Science Handbook</a>.</p>
<div class="section" id="an-aside-on-encodings">
<h2><span class="section-number">1.1. </span>An aside on encodings<a class="headerlink" href="#an-aside-on-encodings" title="Permalink to this headline">¶</a></h2>
<p>Before we get to the good stuff, we need to talk about string encodings. Whether you’re using code or a text editor (Notepad, Word, Pages, Visual Studio Code), every bit of text that you see on a computer will have an encoding behind the scenes that tells the computer how to display the underlying data. There is no such thing as ‘plain’ text: all text on computers is the result of an encoding. Oftentimes, a computer programme (email reader, Word, whatever) will guess the encoding and show you what it thinks the text should look like. But it doesn’t always know, or get it right: <em>that is what is happening when you get an email or open an file full of weird symbols and question marks</em>. If a computer doesn’t know whether a particular string is encoded using UTF-8 or ASCII or ISO 8859-1 (Latin 1) or Windows 1252 (Western European), it simply cannot display it correctly and you get gibberish.</p>
<p>When it comes to encodings, there are just two things to remember: i) you should use UTF-8 (aka Unicode), it’s the international standard. ii) the Windows operating system tends to use either Latin 1 or Windows 1252 but (and this is good news) is moving to UTF-8.</p>
<p><a class="reference external" href="https://www.unicode.org/">Unicode</a> is a specification that aims to list every character used by human languages and give each character its own unique code. The Unicode specifications are continually revised and updated to add new languages and symbols.</p>
<p>Take special care when saving CSV files containing text on a Windows machine using Excel; unless you specify it, the text may not be saved in UTF-8. If your computer and you get confused enough about encodings and re-save a file with the wrong ones, you could lose data.</p>
<p>Hopefully you’ll never have to worry about string encodings. But if you <em>do</em> see weird symbols appearing in your text, at least you’ll know that there’s an encoding problem and will know where to start Googling. You can find a much more in-depth explanation of text encodings <a class="reference external" href="https://kunststube.net/encoding/">here</a>.</p>
</div>
<div class="section" id="strings">
<h2><span class="section-number">1.2. </span>Strings<a class="headerlink" href="#strings" title="Permalink to this headline">¶</a></h2>
<p>Note that there are many built-in functions for using strings in Python, you can find a comprehensive list <a class="reference external" href="https://www.w3schools.com/python/python_ref_string.asp">here</a>.</p>
<p>Strings are the basic data type for text in Python. They can be of any length. A string can be signalled by quote marks or double quote marks like so:</p>
<p><code class="docutils literal notranslate"><span class="pre">'text'</span></code></p>
<p>or</p>
<p><code class="docutils literal notranslate"><span class="pre">&quot;text&quot;</span></code></p>
<p>Style guides tend to prefer the latter but some coders (ahem!) have a bad habit of using the former. We can put this into a variable like so:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">var</span> <span class="o">=</span> <span class="s2">&quot;banana&quot;</span>
</pre></div>
</div>
</div>
</div>
<p>Now, if we check the type of the variable:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">type</span><span class="p">(</span><span class="n">var</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>str
</pre></div>
</div>
</div>
</div>
<p>We see that it is <code class="docutils literal notranslate"><span class="pre">str</span></code>, which is short for string.</p>
<p>Strings in Python can be indexed, so we can get certain characters out by using square brackets to say which positions we would like.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">var</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;ban&#39;
</pre></div>
</div>
</div>
</div>
<p>The usual slicing tricks that apply to lists work for strings too, i.e. the positions you want to get can be retrieved using the <code class="docutils literal notranslate"><span class="pre">var[start:stop:step]</span></code> syntax. Here’s an example of getting every other character from the string starting from the 2nd position.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">var</span><span class="p">[</span><span class="mi">1</span><span class="p">::</span><span class="mi">2</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;aaa&#39;
</pre></div>
</div>
</div>
</div>
<p>Note that strings, like tuples such as <code class="docutils literal notranslate"><span class="pre">(1,</span> <span class="pre">2,</span> <span class="pre">3)</span></code> but unlike lists such as <code class="docutils literal notranslate"><span class="pre">[1,</span> <span class="pre">2,</span> <span class="pre">3]</span></code>, are <em>immutable</em>. This means commands like <code class="docutils literal notranslate"><span class="pre">var[0]</span> <span class="pre">=</span> <span class="pre">&quot;B&quot;</span></code> will result in an error. If you want to change a single character, you will have to replace the entire string. In this example, the command to do that would be <code class="docutils literal notranslate"><span class="pre">var</span> <span class="pre">=</span> <span class="pre">&quot;Banana&quot;</span></code>.</p>
<p>Like lists, you can find the length of a string using <code class="docutils literal notranslate"><span class="pre">len</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">var</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>6
</pre></div>
</div>
</div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">+</span></code> operator concatenates two or more strings:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">second_word</span> <span class="o">=</span> <span class="s1">&#39;panther&#39;</span>
<span class="n">first_word</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span>
<span class="nb">print</span><span class="p">(</span><span class="n">first_word</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="n">second_word</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>black panther
</pre></div>
</div>
</div>
</div>
<p>Note that we added a space so that the noun made sense. Another way of achieving the same end that scales to many words more efficiently (if you have them in a list) is:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">first_word</span><span class="p">,</span> <span class="n">second_word</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;black panther&#39;
</pre></div>
</div>
</div>
</div>
<p>Three useful functions to know about are <code class="docutils literal notranslate"><span class="pre">upper</span></code>, <code class="docutils literal notranslate"><span class="pre">lower</span></code>, and <code class="docutils literal notranslate"><span class="pre">title</span></code>. Let’s see what they do</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">var</span> <span class="o">=</span> <span class="s1">&#39;input TEXT&#39;</span>
<span class="n">var_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">var</span><span class="o">.</span><span class="n">upper</span><span class="p">(),</span> <span class="n">var</span><span class="o">.</span><span class="n">lower</span><span class="p">(),</span> <span class="n">var</span><span class="o">.</span><span class="n">title</span><span class="p">()]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">var_list</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;INPUT TEXT&#39;, &#39;input text&#39;, &#39;Input Text&#39;]
</pre></div>
</div>
</div>
</div>
<div class="admonition-exercise admonition">
<p class="admonition-title">Exercise</p>
<p>Reverse the string <code class="docutils literal notranslate"><span class="pre">&quot;gnirts</span> <span class="pre">desrever</span> <span class="pre">a</span> <span class="pre">si</span> <span class="pre">sihT&quot;</span></code> using indexing operations.</p>
</div>
<p>While we’re using <code class="docutils literal notranslate"><span class="pre">print()</span></code>, it has a few tricks. If we have a list, we can print out entries with a given separator:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="o">*</span><span class="n">var_list</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;; and </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INPUT TEXT; and 
input text; and 
Input Text
</pre></div>
</div>
</div>
</div>
<p>(We’ll find out more about what ‘\n’ does shortly.) To turn variables of other kinds into strings, use the <code class="docutils literal notranslate"><span class="pre">str()</span></code> function, for example</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="s1">&#39;A boolean is either &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; or &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>  <span class="o">+</span> <span class="s1">&#39;, there are only &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; options.&#39;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;A boolean is either True or False, there are only 2 options.&#39;
</pre></div>
</div>
</div>
</div>
<p>In this example two boolean variables and one integer variable were converted to strings. <code class="docutils literal notranslate"><span class="pre">str</span></code> generally makes an intelligent guess at how you’d like to convert your non-string type variable into a string type. You can pass a variable or a literal value to <code class="docutils literal notranslate"><span class="pre">str</span></code>.</p>
<div class="section" id="f-strings">
<h3><span class="section-number">1.2.1. </span>f-strings<a class="headerlink" href="#f-strings" title="Permalink to this headline">¶</a></h3>
<p>The example above is quite verbose. Another way of combining strings with variables is via <em>f-strings</em>. A simple f-string looks like this:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">variable</span> <span class="o">=</span> <span class="mf">15.32399</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;You scored </span><span class="si">{</span><span class="n">variable</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>You scored 15.32399
</pre></div>
</div>
</div>
</div>
<p>This is similar to calling <code class="docutils literal notranslate"><span class="pre">str</span></code> on variable and using <code class="docutils literal notranslate"><span class="pre">+</span></code> for concatenation but much shorter to write. You can add expressions to f-strings too:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;You scored </span><span class="si">{</span><span class="n">variable</span><span class="o">**</span><span class="mi">2</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>You scored 234.8246695201
</pre></div>
</div>
</div>
</div>
<p>This also works with functions; after all <code class="docutils literal notranslate"><span class="pre">**2</span></code> is just a function with its own special syntax.</p>
<p>In this example, the score number that came out had a lot of (probably) uninteresting decimal places. So how do we polish the printed output? You can pass more inforation to the f-string to get the output formatted just the way you want. Let’s say we wanted two decimal places and a sign (although you always write <code class="docutils literal notranslate"><span class="pre">+</span></code> in the formatting, the sign comes out as + or - depending on the value):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;You scored </span><span class="si">{</span><span class="n">variable</span><span class="si">:</span><span class="s2">+.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>You scored +15.32
</pre></div>
</div>
</div>
</div>
<p>There are a whole range of formatting options for numbers as shown in the following table:</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>Number</p></th>
<th class="head"><p>Format</p></th>
<th class="head"><p>Output</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>15.32347</p></td>
<td><p>{:.2f}</p></td>
<td><p>15.32</p></td>
<td><p>Format float 2 decimal places</p></td>
</tr>
<tr class="row-odd"><td><p>15.32347</p></td>
<td><p>{:+.2f}</p></td>
<td><p>+15.32</p></td>
<td><p>Format float 2 decimal places with sign</p></td>
</tr>
<tr class="row-even"><td><p>-1</p></td>
<td><p>{:+.2f}</p></td>
<td><p>-1.00</p></td>
<td><p>Format float 2 decimal places with sign</p></td>
</tr>
<tr class="row-odd"><td><p>15.32347</p></td>
<td><p>{:.0f}</p></td>
<td><p>15</p></td>
<td><p>Format float with no decimal places</p></td>
</tr>
<tr class="row-even"><td><p>3</p></td>
<td><p>{:0&gt;2d}</p></td>
<td><p>03</p></td>
<td><p>Pad number with zeros (left padding, width 2)</p></td>
</tr>
<tr class="row-odd"><td><p>3</p></td>
<td><p>{:*&lt;4d}</p></td>
<td><p>3***</p></td>
<td><p>Pad number with *’s (right padding, width 4)</p></td>
</tr>
<tr class="row-even"><td><p>13</p></td>
<td><p>{:*&lt;4d}</p></td>
<td><p>13**</p></td>
<td><p>Pad number with *’s (right padding, width 4)</p></td>
</tr>
<tr class="row-odd"><td><p>1000000</p></td>
<td><p>{:,}</p></td>
<td><p>1,000,000</p></td>
<td><p>Number format with comma separator</p></td>
</tr>
<tr class="row-even"><td><p>0.25</p></td>
<td><p>{:.1%}</p></td>
<td><p>25.0%</p></td>
<td><p>Format percentage</p></td>
</tr>
<tr class="row-odd"><td><p>1000000000</p></td>
<td><p>{:.2e}</p></td>
<td><p>1.00e+09</p></td>
<td><p>Exponent notation</p></td>
</tr>
<tr class="row-even"><td><p>12</p></td>
<td><p>{:10d}</p></td>
<td><p>12</p></td>
<td><p>Right aligned (default, width 10)</p></td>
</tr>
<tr class="row-odd"><td><p>12</p></td>
<td><p>{:&lt;10d}</p></td>
<td><p>12</p></td>
<td><p>Left aligned (width 10)</p></td>
</tr>
<tr class="row-even"><td><p>12</p></td>
<td><p>{:^10d}</p></td>
<td><p>12</p></td>
<td><p>Center aligned (width 10)</p></td>
</tr>
</tbody>
</table>
<p>As well as using this page interactively through the Colab and Binder links at the top of the page, or downloading this page and using it on your own computer, you can play around with some of these options over at <a class="reference external" href="https://www.python-utils.com/">this link</a>.</p>
</div>
<div class="section" id="special-characters">
<h3><span class="section-number">1.2.2. </span>Special characters<a class="headerlink" href="#special-characters" title="Permalink to this headline">¶</a></h3>
<p>Python has a string module that comes with some useful built-in strings and characters. For example</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">string</span>

<span class="n">string</span><span class="o">.</span><span class="n">punctuation</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;!&quot;#$%&amp;\&#39;()*+,-./:;&lt;=&gt;?@[\\]^_`{|}~&#39;
</pre></div>
</div>
</div>
</div>
<p>gives you all of the punctuation,</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">string</span><span class="o">.</span><span class="n">ascii_letters</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ&#39;
</pre></div>
</div>
</div>
</div>
<p>returns all of the basic letters in the ‘ASCII’ encoding (with <code class="docutils literal notranslate"><span class="pre">.ascii_lowercase</span></code> and <code class="docutils literal notranslate"><span class="pre">.ascii_uppercase</span></code> variants), and</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">string</span><span class="o">.</span><span class="n">digits</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;0123456789&#39;
</pre></div>
</div>
</div>
</div>
<p>gives you the numbers from 0 to 9. Finally, though less impressive visually, <code class="docutils literal notranslate"><span class="pre">string.whitespace</span></code> gives a string containing all of the different (there is more than one!) types of whitespace.</p>
<p>There are other special characters around; in fact, we already met the most famous of them: “\n” for new line. To actually print “\n” we have to ‘escape’ the backward slash by adding another backward slash:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Here is a </span><span class="se">\n</span><span class="s1"> new line&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Here is an </span><span class="se">\\</span><span class="s1">n escaped new line &#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Here is a 
 new line
Here is an \n escaped new line 
</pre></div>
</div>
</div>
</div>
<p>The table below shows the most important escape commands:</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>Code</p></th>
<th class="head"><p>Result</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">\'</span></code></p></td>
<td><p>Single Quote (useful if using <code class="docutils literal notranslate"><span class="pre">'</span></code> for strings)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">\&quot;</span></code></p></td>
<td><p>Double Quote (useful if using <code class="docutils literal notranslate"><span class="pre">&quot;</span></code> for strings)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">\\</span></code></p></td>
<td><p>Backslash</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">\n</span></code></p></td>
<td><p>New Line</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">\r</span></code></p></td>
<td><p>Carriage Return</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">\t</span></code></p></td>
<td><p>Tab</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="cleaning-text">
<h2><span class="section-number">1.3. </span>Cleaning Text<a class="headerlink" href="#cleaning-text" title="Permalink to this headline">¶</a></h2>
<p>You often want to make changes to the text you’re working with. In this section, we’ll look at the various options to do this.</p>
<div class="section" id="replacing-sub-strings">
<h3><span class="section-number">1.3.1. </span>Replacing sub-strings<a class="headerlink" href="#replacing-sub-strings" title="Permalink to this headline">¶</a></h3>
<p>A common text task is to replace a substring within a longer string. Let’s say you have a string variable <code class="docutils literal notranslate"><span class="pre">var</span></code>. You can use <code class="docutils literal notranslate"><span class="pre">.replace(old_text,</span> <span class="pre">new_text)</span></code> to do this.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;Value is objective&quot;</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;objective&quot;</span><span class="p">,</span> <span class="s2">&quot;subjective&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;Value is subjective&#39;
</pre></div>
</div>
</div>
</div>
<p>As with any variable of a specific type (here, string), this would also work with variables:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">text</span> <span class="o">=</span> <span class="s2">&quot;Value is objective&quot;</span>
<span class="n">old_substr</span> <span class="o">=</span> <span class="s2">&quot;objective&quot;</span>
<span class="n">new_substr</span> <span class="o">=</span> <span class="s2">&quot;subjective&quot;</span>
<span class="n">text</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">old_substr</span><span class="p">,</span> <span class="n">new_substr</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;Value is subjective&#39;
</pre></div>
</div>
</div>
</div>
<p>Note that <code class="docutils literal notranslate"><span class="pre">.replace</span></code> performs an exact replace and so is case-sensitive.</p>
</div>
<div class="section" id="replacing-characters-with-translate">
<h3><span class="section-number">1.3.2. </span>Replacing characters with translate<a class="headerlink" href="#replacing-characters-with-translate" title="Permalink to this headline">¶</a></h3>
<p>A character is an individual entry within a string, like the ‘l’ in ‘equilibrium’. You can always count the number of characters in a string variable called <code class="docutils literal notranslate"><span class="pre">var</span></code> by using <code class="docutils literal notranslate"><span class="pre">len(var)</span></code>. A very fast method for replacing individual characters in a string is <code class="docutils literal notranslate"><span class="pre">str.translate</span></code>.</p>
<p>Replacing characters is extremely useful in certain situations, most commonly when you wish to remote all punctuation prior to doing other text analysis. You can use the built-in <code class="docutils literal notranslate"><span class="pre">string.punctuation</span></code> for this.</p>
<p>Let’s see how to use it to remove all of the vowels from some text. With apologies to economist Lisa Cook, we’ll use the abstract from <span id="id1">[<a class="reference internal" href="zreferences.html#id16"><span>12</span></a>]</span> as the text we’ll modify and we’ll first create a dictionary of translations of vowels to nothing, i.e. <code class="docutils literal notranslate"><span class="pre">&quot;&quot;</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">example_text</span> <span class="o">=</span> <span class="s2">&quot;Much recent work has focused on the influence of social capital on innovative outcomes. Little research has been done on disadvantaged groups who were often restricted from participation in social networks that provide information necessary for invention and innovation. Unique new data on African American inventors and patentees between 1843 and 1930 permit an empirical investigation of the relation between social capital and economic outcomes. I find that African Americans used both traditional, i.e., occupation-based, and nontraditional, i.e., civic, networks to maximize inventive output and that laws constraining social-capital formation are most negatively correlated with economically important inventive activity.&quot;</span>
<span class="n">vowels</span> <span class="o">=</span> <span class="s1">&#39;aeiou&#39;</span>
<span class="n">translation_dict</span> <span class="o">=</span> <span class="p">{</span><span class="n">x</span><span class="p">:</span> <span class="s2">&quot;&quot;</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">vowels</span><span class="p">}</span>
<span class="n">translation_dict</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;a&#39;: &#39;&#39;, &#39;e&#39;: &#39;&#39;, &#39;i&#39;: &#39;&#39;, &#39;o&#39;: &#39;&#39;, &#39;u&#39;: &#39;&#39;}
</pre></div>
</div>
</div>
</div>
<p>Now we turn our dictionary into a string translator and apply it to our text:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">translator</span> <span class="o">=</span> <span class="n">example_text</span><span class="o">.</span><span class="n">maketrans</span><span class="p">(</span><span class="n">translation_dict</span><span class="p">)</span>
<span class="n">example_text</span><span class="o">.</span><span class="n">translate</span><span class="p">(</span><span class="n">translator</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;Mch rcnt wrk hs fcsd n th nflnc f scl cptl n nnvtv tcms. Lttl rsrch hs bn dn n dsdvntgd grps wh wr ftn rstrctd frm prtcptn n scl ntwrks tht prvd nfrmtn ncssry fr nvntn nd nnvtn. Unq nw dt n Afrcn Amrcn nvntrs nd ptnts btwn 1843 nd 1930 prmt n mprcl nvstgtn f th rltn btwn scl cptl nd cnmc tcms. I fnd tht Afrcn Amrcns sd bth trdtnl, .., ccptn-bsd, nd nntrdtnl, .., cvc, ntwrks t mxmz nvntv tpt nd tht lws cnstrnng scl-cptl frmtn r mst ngtvly crrltd wth cnmclly mprtnt nvntv ctvty.&#39;
</pre></div>
</div>
</div>
</div>
<div class="admonition-exercise admonition">
<p class="admonition-title">Exercise</p>
<p>Use <code class="docutils literal notranslate"><span class="pre">translate</span></code> to replace all puncuation from the following sentence with spaces: “The well-known story I told at the conferences [about hypocondria] in Boston, New York, Philadelphia,…and Richmond went as follows: It amused people who knew Tommy to hear this; however, it distressed Suzi when Tommy (1982–2019) asked, “How can I find out who yelled, ‘Fire!’ in the theater?” and then didn’t wait to hear Missy give the answer—‘Dick Tracy.’”</p>
</div>
<p>Generally, <code class="docutils literal notranslate"><span class="pre">str.translate</span></code> is very fast at replacing individual characters in strings. But you can also do it using a list comprehension and a <code class="docutils literal notranslate"><span class="pre">join</span></code> of the resulting list, like so:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">ch</span> <span class="k">for</span> <span class="n">ch</span> <span class="ow">in</span> <span class="s2">&quot;Example. string. with- excess_ [punctuation]/,&quot;</span> <span class="k">if</span> <span class="n">ch</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">string</span><span class="o">.</span><span class="n">punctuation</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;Example string with excess punctuation&#39;
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="slugifying">
<h3><span class="section-number">1.3.3. </span>Slugifying<a class="headerlink" href="#slugifying" title="Permalink to this headline">¶</a></h3>
<p>A special case of string cleaning occurs when you are given text with lots of non-standard characters in, and spaces, and other symbols; and what you want is a clean string suitable for a filename or column heading in a dataframe. Remember that it’s best practice to have filenames that don’t have spaces in. Slugiyfing is the process of creating the latter from the former and we can use the <a class="reference external" href="https://github.com/un33k/python-slugify"><strong>slugify</strong></a> package to do it.</p>
<p>Here are some examples of slugifying text:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">slugify</span> <span class="kn">import</span> <span class="n">slugify</span>
<span class="n">txt</span> <span class="o">=</span> <span class="s1">&#39;the quick brown fox jumps over the lazy dog&#39;</span>
<span class="n">slugify</span><span class="p">(</span><span class="n">txt</span><span class="p">,</span> <span class="n">stopwords</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;the&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;quick-brown-fox-jumps-over-lazy-dog&#39;
</pre></div>
</div>
</div>
</div>
<p>In this very simple example, the words listed in the <code class="docutils literal notranslate"><span class="pre">stopwords=</span></code> keyword argument (a list), are removed and spaces are replaced by hyphens. Let’s now see a more complicated example:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">slugify</span><span class="p">(</span><span class="s1">&#39;当我的信息改变时... àccêntæd tËXT  &#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;dang-wo-de-xin-xi-gai-bian-shi-accentaed-text&#39;
</pre></div>
</div>
</div>
</div>
<p>Slugify converts text to latin characters, while also removing accents and whitespace (of all kinds-the last whitespace is a tab). There’s also a <code class="docutils literal notranslate"><span class="pre">replacement=</span></code> keyword argument that will replace specific strings with other strings using a list of lists format, eg <code class="docutils literal notranslate"><span class="pre">replacement=[['old_text',</span> <span class="pre">'new_text']]</span></code></p>
</div>
<div class="section" id="splitting-strings">
<h3><span class="section-number">1.3.4. </span>Splitting strings<a class="headerlink" href="#splitting-strings" title="Permalink to this headline">¶</a></h3>
<p>If you want to split a string at a certain position, there are two quick ways to do it. The first is to use indexing methods, which work well if you know at which position you want to split text, eg</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;This is a sentence and we will split it at character 18&quot;</span><span class="p">[:</span><span class="mi">18</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;This is a sentence&#39;
</pre></div>
</div>
</div>
</div>
<p>Next up we can use the built-in <code class="docutils literal notranslate"><span class="pre">split</span></code> function, which returns a list of places where a given sub-string occurs:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;This is a sentence. And another sentence. And a third sentence&quot;</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;This is a sentence&#39;, &#39; And another sentence&#39;, &#39; And a third sentence&#39;]
</pre></div>
</div>
</div>
</div>
<p>Note that the character used to split the string is removed from the resulting list of strings. Let’s see an example with a string used for splitting instead of a single character:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;This is a sentence. And another sentence. And a third sentence&quot;</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;sentence&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;This is a &#39;, &#39;. And another &#39;, &#39;. And a third &#39;, &#39;&#39;]
</pre></div>
</div>
</div>
</div>
<p>A useful extra function to know about is <code class="docutils literal notranslate"><span class="pre">splitlines()</span></code>, which splits a string at line breaks and returns the split parts as a list.</p>
</div>
<div class="section" id="count-and-find">
<h3><span class="section-number">1.3.5. </span>count and find<a class="headerlink" href="#count-and-find" title="Permalink to this headline">¶</a></h3>
<p>Let’s do some simple counting of words within text using <code class="docutils literal notranslate"><span class="pre">str.count</span></code>. Let’s use the first verse of Elizabeth Bishop’s sestina ‘A Miracle for Breakfast’ for our text.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">text</span> <span class="o">=</span> <span class="s2">&quot;At six o&#39;clock we were waiting for coffee, </span><span class="se">\n</span><span class="s2"> waiting for coffee and the charitable crumb </span><span class="se">\n</span><span class="s2"> that was going to be served from a certain balcony </span><span class="se">\n</span><span class="s2"> --like kings of old, or like a miracle. </span><span class="se">\n</span><span class="s2"> It was still dark. One foot of the sun </span><span class="se">\n</span><span class="s2"> steadied itself on a long ripple in the river.&quot;</span>
<span class="n">word</span> <span class="o">=</span> <span class="s2">&quot;coffee&quot;</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The word &quot;</span><span class="si">{</span><span class="n">word</span><span class="si">}</span><span class="s1">&quot; appears </span><span class="si">{</span><span class="n">text</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">word</span><span class="p">)</span><span class="si">}</span><span class="s1"> times.&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The word &quot;coffee&quot; appears 2 times.
</pre></div>
</div>
</div>
</div>
<p>Meanwhile, <code class="docutils literal notranslate"><span class="pre">find</span></code> returns the position where a particular word or character occurs.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">text</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">word</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>35
</pre></div>
</div>
</div>
</div>
<p>We can check this using the number we get and some string indexing:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">text</span><span class="p">[</span><span class="n">text</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">word</span><span class="p">):</span><span class="n">text</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">word</span><span class="p">)</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">word</span><span class="p">)]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;coffee&#39;
</pre></div>
</div>
</div>
</div>
<p>But this isn’t the only place where the word ‘coffee’ appears. If we want to find the last occurrence, it’s</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">text</span><span class="o">.</span><span class="n">rfind</span><span class="p">(</span><span class="n">word</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>57
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="regular-expressions">
<h2><span class="section-number">1.4. </span>Regular expressions<a class="headerlink" href="#regular-expressions" title="Permalink to this headline">¶</a></h2>
<p>Regex, aka regular expressions, provide a way to both search and change text. Their advantages are that they are concise, they run very quickly, they can be ported across languages (they are definitely not just a Python thing!), and they are very powerful. The disadvantage is that they are confusing and take some getting used to!</p>
<p>You can live code regex in a couple of places, the first is within Visual Studio Code itself. Do this by clicking the magnifying glass in the left-hand side panel of options. When the search strip appears, you can put a search term in. To the right of the text entry box, there are three buttons, one of which is a period (full stop) followed by an asterisk. This option allows the Visual Studio text search function to accept regular expressions. This will apply regex to all of the text in your current Visual Studio workspace.</p>
<p>Another approach is to head over to <a class="reference external" href="https://regex101.com/">https://regex101.com/</a> and begin typing your regular expression there. You will need to add some text in the box for the regex to be applied to.</p>
<p>Try either of the above with the regex <code class="docutils literal notranslate"><span class="pre">string</span> <span class="pre">\w+\s</span></code>. This matches any occurrence of the word ‘string’ that is followed by another word and then a whitespace. As an example, ‘string cleaning ‘ would be picked up as a match when using this regex.</p>
<p>Within Python, the <code class="docutils literal notranslate"><span class="pre">re</span></code> library provides support for regular expressions. Let’s try it:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">re</span>
<span class="n">text</span> <span class="o">=</span> <span class="s2">&quot;It is true that string cleaning is a topic in this chapter. string editing is another.&quot;</span>
<span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s2">&quot;string \w+\s&quot;</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;string cleaning &#39;, &#39;string editing &#39;]
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">re.findall</span></code> returns all matches. There are several useful search-like functions in <code class="docutils literal notranslate"><span class="pre">re</span></code> to be aware of that have a similar syntax of <code class="docutils literal notranslate"><span class="pre">re.function(regex,</span> <span class="pre">text)</span></code>. The table shows what they all do</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>Function</p></th>
<th class="head"><p>What it does</p></th>
<th class="head"><p>Example of use</p></th>
<th class="head"><p>Output for given value of <code class="docutils literal notranslate"><span class="pre">text</span></code></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">re.match</span></code></p></td>
<td><p>Declares whether there is a match at the beginning of a string.</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">re.match(&quot;string</span> <span class="pre">\w+\s&quot;</span> <span class="pre">,</span> <span class="pre">text)</span> <span class="pre">is</span> <span class="pre">True</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">None</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">re.search</span></code></p></td>
<td><p>Declares whether there is a match anywhere in the string.</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">re.search(&quot;string</span> <span class="pre">\w+\s&quot;</span> <span class="pre">,</span> <span class="pre">text)</span> <span class="pre">is</span> <span class="pre">True</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">True</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">re.findall</span></code></p></td>
<td><p>Returns all matches.</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">re.findall(&quot;string</span> <span class="pre">\w+\s&quot;</span> <span class="pre">,</span> <span class="pre">text)</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">['string</span> <span class="pre">cleaning</span> <span class="pre">',</span> <span class="pre">'string</span> <span class="pre">editing</span> <span class="pre">']</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">re.split</span></code></p></td>
<td><p>Splits text wherever a match occurs.</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">re.split(&quot;string</span> <span class="pre">\w+\s&quot;</span> <span class="pre">,</span> <span class="pre">text)</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">['It</span> <span class="pre">is</span> <span class="pre">true</span> <span class="pre">that</span> <span class="pre">',</span> <span class="pre">'is</span> <span class="pre">a</span> <span class="pre">topic</span> <span class="pre">in</span> <span class="pre">this</span> <span class="pre">chapter.</span> <span class="pre">',</span> <span class="pre">'is</span> <span class="pre">another.']</span></code></p></td>
</tr>
</tbody>
</table>
<p>Another really handy regex function is <code class="docutils literal notranslate"><span class="pre">re.sub</span></code>, which substitutes one bit of text for another if it finds a match. Here’s an example:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">new_text</span> <span class="o">=</span> <span class="s1">&#39;new text here! &#39;</span>
<span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s2">&quot;string \w+\s&quot;</span><span class="p">,</span> <span class="n">new_text</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;It is true that new text here! is a topic in this chapter. new text here! is another.&#39;
</pre></div>
</div>
</div>
</div>
<div class="section" id="id2">
<h3><span class="section-number">1.4.1. </span>Special Characters<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h3>
<p>So far, we’ve only seen a very simple application of regex involving a vanilla word, <code class="docutils literal notranslate"><span class="pre">string</span></code>, the code for another word <code class="docutils literal notranslate"><span class="pre">\w+</span></code> and the code for a whitespace <code class="docutils literal notranslate"><span class="pre">\s</span></code>. Let’s take a more comprehensive look at the regex special characters:</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>Character</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>Example Text</p></th>
<th class="head"><p>Example Regex</p></th>
<th class="head"><p>Example Match Text</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>\d</p></td>
<td><p>One Unicode digit in any script</p></td>
<td><p>“file_93 is open”</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">file_\d\d</span></code></p></td>
<td><p>“file_93”</p></td>
</tr>
<tr class="row-odd"><td><p>\w</p></td>
<td><p>“word character”: Unicode letter, digit, or underscore</p></td>
<td><p>“blah hello-word blah”</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">\w-\w</span></code></p></td>
<td><p>“hello-world”</p></td>
</tr>
<tr class="row-even"><td><p>\s</p></td>
<td><p>“whitespace character”: any Unicode separator</p></td>
<td><p>“these are some words with spaces”</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">words\swith\sspaces</span></code></p></td>
<td><p>“words with spaces”</p></td>
</tr>
<tr class="row-odd"><td><p>\D</p></td>
<td><p>Non-digit character (opposite of \d)</p></td>
<td><p>“ABC 10323982328”</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">\D\D\D</span></code></p></td>
<td><p>“ABC”</p></td>
</tr>
<tr class="row-even"><td><p>\W</p></td>
<td><p>Non-word character (opposite of \w)</p></td>
<td><p>“Once upon a time *”</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">\W</span></code></p></td>
<td><p>“*”</p></td>
</tr>
<tr class="row-odd"><td><p>\S</p></td>
<td><p>Non-whitespace character (opposite of \s)</p></td>
<td><p>“y        “</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">\S</span></code></p></td>
<td><p>“y”</p></td>
</tr>
<tr class="row-even"><td><p>\Z</p></td>
<td><p>End of string</p></td>
<td><p>“End of a string”</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">\w+\Z</span></code></p></td>
<td><p>“string””</p></td>
</tr>
<tr class="row-odd"><td><p>.</p></td>
<td><p>Match any character except the newline</p></td>
<td><p>“ab=def”</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ab.def</span></code></p></td>
<td><p>“ab=def”</p></td>
</tr>
</tbody>
</table>
<p>Note that whitespace characters include newlines, <code class="docutils literal notranslate"><span class="pre">\n</span></code>, and tabs, <code class="docutils literal notranslate"><span class="pre">\t</span></code>.</p>
</div>
<div class="section" id="quantifiers">
<h3><span class="section-number">1.4.2. </span>Quantifiers<a class="headerlink" href="#quantifiers" title="Permalink to this headline">¶</a></h3>
<p>As well as these special characters, there are quantifiers which ask for more than one occurence of a character. For example, in the above, <code class="docutils literal notranslate"><span class="pre">\w\w</span></code> asked for two word characters, while <code class="docutils literal notranslate"><span class="pre">\d\d</span></code> asks for two digits. The next table shows all of the quantifiers.</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>Quantifier</p></th>
<th class="head"><p>Role</p></th>
<th class="head"><p>Example Text</p></th>
<th class="head"><p>Example Regex</p></th>
<th class="head"><p>Example Match</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>{m}</p></td>
<td><p>Exactly m repetitions</p></td>
<td><p>“936 and 42 are the codes”</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">\d{3}</span></code></p></td>
<td><p>“936”</p></td>
</tr>
<tr class="row-odd"><td><p>{m,n}</p></td>
<td><p>From m (default 0) to n (default infinity)</p></td>
<td><p>“Words up to four letters”</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">\b\w{1,4}\b</span></code></p></td>
<td><p>“up”, “to”, “four”</p></td>
</tr>
<tr class="row-even"><td><p>*</p></td>
<td><p>0 or more. Same as {,}</p></td>
<td><p>“42 is the code”</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">\d*\s</span></code></p></td>
<td><p>“42”</p></td>
</tr>
<tr class="row-odd"><td><p>+</p></td>
<td><p>1 or more. Same as {1,}</p></td>
<td><p>“4 323 hello”</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">\d+</span></code></p></td>
<td><p>“4”, “323”</p></td>
</tr>
<tr class="row-even"><td><p>?</p></td>
<td><p>Optional, so 0 or 1. Same as {,1}.</p></td>
<td><p>“4 323 hello”</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">\d?\s</span></code></p></td>
<td><p>“4”</p></td>
</tr>
</tbody>
</table>
<div class="admonition-exercise admonition">
<p class="admonition-title">Exercise</p>
<p>Find a single regex that will pick out only the percentage numbers from both “Inflation in year 3 was 2 percent” and “Interest rates were as high as 12 percent”.</p>
</div>
</div>
<div class="section" id="metacharacters">
<h3><span class="section-number">1.4.3. </span>Metacharacters<a class="headerlink" href="#metacharacters" title="Permalink to this headline">¶</a></h3>
<p>Now, as well as special characters and quantifiers, we can have meta-character matches. These are not characters <em>per se</em>, but starts, ends, and other bits of words. For example, <code class="docutils literal notranslate"><span class="pre">\b</span></code> matches strings at a word (<code class="docutils literal notranslate"><span class="pre">\w+</span></code>) boundary, so if we took the text “Three letter words only are captured” and ran <code class="docutils literal notranslate"><span class="pre">\b\w\w\w\b</span></code> we would return “are”. <code class="docutils literal notranslate"><span class="pre">\B</span></code> matches strings not at word (<code class="docutils literal notranslate"><span class="pre">\w+</span></code>) boundaries so the text “Bricks” with <code class="docutils literal notranslate"><span class="pre">\B\w\w\B</span></code> applied would yield “ri”. The next table contains some useful metacharacters.</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>Metacharacter Sequence</p></th>
<th class="head"><p>Meaning</p></th>
<th class="head"><p>Example Regex</p></th>
<th class="head"><p>Example Match</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>^</p></td>
<td><p>Start of string or line</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">^abc</span></code></p></td>
<td><p>“abc” (appearing at start of string or line)</p></td>
</tr>
<tr class="row-odd"><td><p>$</p></td>
<td><p>End of string, or end of line</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">xyz$</span></code></p></td>
<td><p>“xyz” (appearing at end of string or line)</p></td>
</tr>
<tr class="row-even"><td><p>\b</p></td>
<td><p>Match string at word (\w+) boundary</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ing\b</span></code></p></td>
<td><p>“match<strong>ing</strong>” (matches ing if it is at the end of a word)</p></td>
</tr>
<tr class="row-odd"><td><p>\B</p></td>
<td><p>Match string not at word (\w+) boundary</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">\Bing\B</span></code></p></td>
<td><p>“st<strong>ing</strong>er” (matches ing if it is not at the beginning or end of the word)</p></td>
</tr>
</tbody>
</table>
<p>Because so many characters have special meaning in regex, if you want to look for, say, a dollar sign or a dot, you need to escape the character first with a backward slash. So <code class="docutils literal notranslate"><span class="pre">\${1}\d+</span></code> would look for a single dollar sign followed by some digits and would pick up the ‘$50’ in ‘she made $50 dollars’.</p>
<div class="admonition-exercise admonition">
<p class="admonition-title">Exercise</p>
<p>Find the regex that will pick out only the first instance of the word ‘money’ and any word subsequent to ‘money’ from the following: “money supply has grown considerably. money demand has not kept up.”.</p>
</div>
</div>
<div class="section" id="ranges">
<h3><span class="section-number">1.4.4. </span>Ranges<a class="headerlink" href="#ranges" title="Permalink to this headline">¶</a></h3>
<p>You probably think you’re done with regex, but not so fast! There are more metacharacters to come. This time, they will represent <em>ranges</em> of characters.</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>Metacharacter Sequence</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>Example Expression</p></th>
<th class="head"><p>Example Match</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>[characters]</p></td>
<td><p>The characters inside the brackets are part of a matching-character set</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">[abcd]</span></code></p></td>
<td><p>a, b, c, d, abcd</p></td>
</tr>
<tr class="row-odd"><td><p>[^…]</p></td>
<td><p>Characters inside brackets are a non-matching set; a character not inside is a matching character.</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">[^abcd]</span></code></p></td>
<td><p>Any occurrence of any character EXCEPT a, b, c, d.</p></td>
</tr>
<tr class="row-even"><td><p>[character-character]</p></td>
<td><p>Any character in the range between two characters (inclusive) is part of the set</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">[a-z]</span></code></p></td>
<td><p>Any lowercase letter</p></td>
</tr>
<tr class="row-odd"><td><p>[^character]</p></td>
<td><p>Any character that is not the listed character</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">[^A]</span></code></p></td>
<td><p>Any character EXCEPT capital A</p></td>
</tr>
</tbody>
</table>
<p>Ranges have two more neat tricks. The first is that they can be concatenated. For example, <code class="docutils literal notranslate"><span class="pre">[a-c-1-5]</span></code> would match any of a, b, c, 1, 2, 3, 4, 5. They can also be modified with a quantifier, so <code class="docutils literal notranslate"><span class="pre">[a-c0-2]{2}</span></code> would match “a0” and “ab”.</p>
</div>
<div class="section" id="greedy-versus-lazy-regexes">
<h3><span class="section-number">1.4.5. </span>Greedy versus lazy regexes<a class="headerlink" href="#greedy-versus-lazy-regexes" title="Permalink to this headline">¶</a></h3>
<p>Buckle up, because this one is a bit tricky to grasp. Adding a <code class="docutils literal notranslate"><span class="pre">?</span></code> after a regex will make it go from being ‘greedy’ to being ‘lazy’. Greedy means that you will match the longest possible string that hits the condition. Lazy will mean that you get the shortest possible string matching the condition. It’s easiest to demonstrate with an example:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">test_string</span> <span class="o">=</span> <span class="s2">&quot;stackoverflow&quot;</span>
<span class="n">greedy_regex</span> <span class="o">=</span> <span class="s2">&quot;s.*o&quot;</span>
<span class="n">lazy_regex</span> <span class="o">=</span> <span class="s2">&quot;s.*?o&quot;</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The greedy match is </span><span class="si">{</span><span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">greedy_regex</span><span class="p">,</span> <span class="n">test_string</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The lazy match is </span><span class="si">{</span><span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">lazy_regex</span><span class="p">,</span> <span class="n">test_string</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The greedy match is stackoverflo
The lazy match is stacko
</pre></div>
</div>
</div>
</div>
<p>In the former (greedy) case, we get from an ‘s’ all the way to the last ‘o’ within the same word. In the latter (lazy) case we just get everything between the start and first occurrence of an ‘o’.</p>
</div>
<div class="section" id="matches-versus-capture-groups">
<h3><span class="section-number">1.4.6. </span>Matches versus capture groups<a class="headerlink" href="#matches-versus-capture-groups" title="Permalink to this headline">¶</a></h3>
<p>There is often a difference between what you might want to match and what you actually want to <em>grab</em> with your regex. Let’s say, for example, we’re parsing some text and we want any numbers that follow the format ‘$xx.xx’, where the ‘x’ are numbers but we don’t want the dollar sign. To do this, we can create a <em>capture group</em> using brackets. Here’s an example:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">text</span> <span class="o">=</span> <span class="s2">&quot;Product 1 was $45.34, while product 2 came in at $50.00 however it was assessed that the $4.66 difference did not make up for the higher quality of product 2.&quot;</span>
<span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s2">&quot;\$(\d</span><span class="si">{2}</span><span class="s2">.\d</span><span class="si">{2}</span><span class="s2">)&quot;</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;45.34&#39;, &#39;50.00&#39;]
</pre></div>
</div>
</div>
</div>
<p>Let’s pick apart the regex here. First, we asked for a literal dollar sign using <code class="docutils literal notranslate"><span class="pre">\$</span></code>. Next, we opened up a capture group with <code class="docutils literal notranslate"><span class="pre">(</span></code>. Then we said only give us the numbers that are 2 digits, a period, and another 2 digits (thus excluding $4.66). Finally, we closed the capture group with <code class="docutils literal notranslate"><span class="pre">)</span></code>.</p>
<p>So while we specify a <em>match</em> using regex, while only want running the regex to return the <em>capture group</em>.</p>
<p>Let’s see a more complicated example.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sal_r_per</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;\b([0-9]{1,6}(?:\.)?(?:[0-9]{1,2})?(?:\s?-\s?|\s?to\s?)[0-9]{1,6}(?:\.)?(?:[0-9]{1,2})?)(?:\s?per)\b&quot;</span>
<span class="n">text</span> <span class="o">=</span> <span class="s2">&quot;This job pays gbp 30500.00 to 35000 per year. Apply at number 100 per the below address.&quot;</span>
<span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">sal_r_per</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;30500.00 to 35000&#39;]
</pre></div>
</div>
</div>
</div>
<p>In this case, the regex first looks for up to 6 digits, then optionally a period, then optionally another couple of digits, then either a dash or ‘to’ using the ‘|’ operator (which means or), followed by a similar number, followed by ‘per’.</p>
<p>But the capture group is only the subset of the match that is the number range-we discard most of the rest. Note also that other numbers, even if they are followed by ‘per’, are not picked up. <code class="docutils literal notranslate"><span class="pre">(?:)</span></code> begins a <em>non-capture group</em>, which matches only but does not capture, so that although <code class="docutils literal notranslate"><span class="pre">(?:\s?per)</span></code> looks for ” per” after a salary (with the space optional due to the second <code class="docutils literal notranslate"><span class="pre">?</span></code>), it does not get returned.</p>
<div class="admonition-exercise admonition">
<p class="admonition-title">Exercise</p>
<p>Find a regex that captures the wage range from “Salary Pay in range <span class="math notranslate nohighlight">\(9.00 - \)</span>12.02 but you must start at 8.00 - 8.30 every morning.”.</p>
</div>
<p>This has been a whirlwind tour of regexes. Although regex looks a lot like gobbledygook, it is a really useful tool to be able to deploy for more complex string cleaning and extraction tasks.</p>
</div>
</div>
<div class="section" id="scaling-up-from-a-single-string-to-a-corpus">
<h2><span class="section-number">1.5. </span>Scaling up from a single string to a corpus<a class="headerlink" href="#scaling-up-from-a-single-string-to-a-corpus" title="Permalink to this headline">¶</a></h2>
<p>For this section, it’s useful to be familiar with the <strong>pandas</strong> package, which is covered in the <a class="reference internal" href="data-analysis-quickstart.html#data-quickstart"><span class="std std-ref">Data Analysis Quickstart</span></a> and <a class="reference internal" href="data-intro.html#working-with-data"><span class="std std-ref">Working with Data</span></a> sections. This section will closely follow the treatment by Jake VanderPlas.</p>
<p>We’ve seen how to work with individual strings. But often we want to work with a group of strings, otherwise known as a corpus, that is a collection of texts. It could be a collection of words, sentences, paragraphs, or some domain-based grouping (eg job descriptions).</p>
<p>Fortunately, many of the methods that we have seen deployed on a single string can be straightforwardly scaled up to hundreds, thousands, or millions of strings using <strong>pandas</strong> or other tools. This scaling up is achieved via <em>vectorisation</em>, in analogy with going from a single value (a scalar) to multiple values in a list (a vector).</p>
<p>As a very minimal example, here is capitalisation of names vectorised using a list comprehension:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">name</span><span class="o">.</span><span class="n">capitalize</span><span class="p">()</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;ada&#39;</span><span class="p">,</span> <span class="s1">&#39;adam&#39;</span><span class="p">,</span> <span class="s1">&#39;elinor&#39;</span><span class="p">,</span> <span class="s1">&#39;grace&#39;</span><span class="p">,</span> <span class="s1">&#39;jean&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;Ada&#39;, &#39;Adam&#39;, &#39;Elinor&#39;, &#39;Grace&#39;, &#39;Jean&#39;]
</pre></div>
</div>
</div>
</div>
<p>A <strong>pandas</strong> series can be used in place of a list. Let’s create the series first:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="n">dfs</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="s1">&#39;ada lovelace&#39;</span><span class="p">,</span> <span class="s1">&#39;adam smith&#39;</span><span class="p">,</span> <span class="s1">&#39;elinor ostrom&#39;</span><span class="p">,</span> <span class="s1">&#39;grace hopper&#39;</span><span class="p">,</span> <span class="s1">&#39;jean bartik&#39;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;string&quot;</span><span class="p">)</span>
<span class="n">dfs</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0     ada lovelace
1       adam smith
2    elinor ostrom
3     grace hopper
4      jean bartik
dtype: string
</pre></div>
</div>
</div>
</div>
<p>Now we use the syntax series.str.function to change the text series:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dfs</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">title</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0     Ada Lovelace
1       Adam Smith
2    Elinor Ostrom
3     Grace Hopper
4      Jean Bartik
dtype: string
</pre></div>
</div>
</div>
</div>
<p>If we had a dataframe and not a series, the syntax would change to refer just to the column of interest like so:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">dfs</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;names&#39;</span><span class="p">])</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;names&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">title</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0     Ada Lovelace
1       Adam Smith
2    Elinor Ostrom
3     Grace Hopper
4      Jean Bartik
Name: names, dtype: string
</pre></div>
</div>
</div>
</div>
<p>The table below shows a non-exhaustive list of the string methods that are available in <strong>pandas</strong>.</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>Function (preceded by <code class="docutils literal notranslate"><span class="pre">.str.</span></code>)</p></th>
<th class="head"><p>What it does</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">len()</span></code></p></td>
<td><p>Length of string.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">lower()</span></code></p></td>
<td><p>Put string in lower case.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">upper()</span></code></p></td>
<td><p>Put string in upper case.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">capitalize()</span></code></p></td>
<td><p>Put string in leading upper case.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">swapcase()</span></code></p></td>
<td><p>Swap cases in a string.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">translate()</span></code></p></td>
<td><p>Returns a copy of the string in which each character has been mapped through a given translation table.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">ljust()</span></code></p></td>
<td><p>Left pad a string (default is to pad with spaces)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">rjust()</span></code></p></td>
<td><p>Right pad a string (default is to pad with spaces)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">center()</span></code></p></td>
<td><p>Pad such that string appears in centre (default is to pad with spaces)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">zfill()</span></code></p></td>
<td><p>Pad with zeros</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">strip()</span></code></p></td>
<td><p>Strip out leading and trailing whitespace</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">rstrip()</span></code></p></td>
<td><p>Strip out trailing whitespace</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">lstrip()</span></code></p></td>
<td><p>Strip out leading whitespace</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">find()</span></code></p></td>
<td><p>Return the lowest index in the data where a substring appears</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">split()</span></code></p></td>
<td><p>Split the string using a passed substring as the delimiter</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">isupper()</span></code></p></td>
<td><p>Check whether string is upper case</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">isdigit()</span></code></p></td>
<td><p>Check whether string is composed of digits</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">islower()</span></code></p></td>
<td><p>Check whether string is lower case</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">startswith()</span></code></p></td>
<td><p>Check whether string starts with a given sub-string</p></td>
</tr>
</tbody>
</table>
<p>Regular expressions can also be scaled up with <strong>pandas</strong>. The below table shows vectorised regular expressions.</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>Function</p></th>
<th class="head"><p>What it does</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">match()</span></code></p></td>
<td><p>Call <code class="docutils literal notranslate"><span class="pre">re.match()</span></code> on each element, returning a boolean.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">extract()</span></code></p></td>
<td><p>Call <code class="docutils literal notranslate"><span class="pre">re.match()</span></code> on each element, returning matched groups as strings.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">findall()</span></code></p></td>
<td><p>Call <code class="docutils literal notranslate"><span class="pre">re.findall()</span></code> on each element</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">replace()</span></code></p></td>
<td><p>Replace occurrences of pattern with some other string</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">contains()</span></code></p></td>
<td><p>Call <code class="docutils literal notranslate"><span class="pre">re.search()</span></code> on each element, returning a boolean</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">count()</span></code></p></td>
<td><p>Count occurrences of pattern</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">split()</span></code></p></td>
<td><p>Equivalent to <code class="docutils literal notranslate"><span class="pre">str.split()</span></code>, but accepts regexes</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">rsplit()</span></code></p></td>
<td><p>Equivalent to <code class="docutils literal notranslate"><span class="pre">str.rsplit()</span></code>, but accepts regexes</p></td>
</tr>
</tbody>
</table>
<p>Let’s see a couple of these in action. First, splitting on a given sub-string:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;names&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0     [ada, lovelace]
1       [adam, smith]
2    [elinor, ostrom]
3     [grace, hopper]
4      [jean, bartik]
Name: names, dtype: object
</pre></div>
</div>
</div>
</div>
<p>It’s fairly common that you want to split out strings and save the results to new columns in your dataframe. You can specify a (max) number of splits via the <code class="docutils literal notranslate"><span class="pre">n=</span></code> kwarg and you can get the columns using <code class="docutils literal notranslate"><span class="pre">expand</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;names&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">expand</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>ada</td>
      <td>lovelace</td>
    </tr>
    <tr>
      <th>1</th>
      <td>adam</td>
      <td>smith</td>
    </tr>
    <tr>
      <th>2</th>
      <td>elinor</td>
      <td>ostrom</td>
    </tr>
    <tr>
      <th>3</th>
      <td>grace</td>
      <td>hopper</td>
    </tr>
    <tr>
      <th>4</th>
      <td>jean</td>
      <td>bartik</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="admonition-exercise admonition">
<p class="admonition-title">Exercise</p>
<p>Using vectorised operations, create a new column with the index position where the first vowel occurs for each row in the <code class="docutils literal notranslate"><span class="pre">names</span></code> column.</p>
</div>
<p>Here’s an example of using a regex function with <strong>pandas</strong>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;names&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">extract</span><span class="p">(</span><span class="s1">&#39;(\w+)&#39;</span><span class="p">,</span> <span class="n">expand</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0       ada
1      adam
2    elinor
3     grace
4      jean
Name: names, dtype: string
</pre></div>
</div>
</div>
</div>
<p>There are a few more vectorised string operations that are useful.</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>Method</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">get()</span></code></p></td>
<td><p>Index each element</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">slice()</span></code></p></td>
<td><p>Slice each element</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">slice_replace()</span></code></p></td>
<td><p>Replace slice in each element with passed value</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">cat()</span></code></p></td>
<td><p>Concatenate strings</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">repeat()</span></code></p></td>
<td><p>Repeat values</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">normalize()</span></code></p></td>
<td><p>Return Unicode form of string</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">pad()</span></code></p></td>
<td><p>Add whitespace to left, right, or both sides of strings</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">wrap()</span></code></p></td>
<td><p>Split long strings into lines with length less than a given width</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">join()</span></code></p></td>
<td><p>Join strings in each element of the Series with passed separator</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">get_dummies()</span></code></p></td>
<td><p>extract dummy variables as a dataframe</p></td>
</tr>
</tbody>
</table>
<p>The <code class="docutils literal notranslate"><span class="pre">get()</span></code> and <code class="docutils literal notranslate"><span class="pre">slice()</span></code> methods give access to elements of the lists returned by <code class="docutils literal notranslate"><span class="pre">split()</span></code>. Here’s an example that combines <code class="docutils literal notranslate"><span class="pre">split()</span></code> and <code class="docutils literal notranslate"><span class="pre">get()</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;names&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">split</span><span class="p">()</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0    lovelace
1       smith
2      ostrom
3      hopper
4      bartik
Name: names, dtype: object
</pre></div>
</div>
</div>
</div>
<p>We already saw <code class="docutils literal notranslate"><span class="pre">get_dummies()</span></code> in the <a class="reference internal" href="econmt-regression.html#regression"><span class="std std-ref">Regression</span></a> chapter, but it’s worth revisiting it here with strings. If we have a column with tags split by a symbol, we can use this function to split it out. For example, let’s create a dataframe with a single column that mixes subject and nationality tags:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;names&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;ada lovelace&#39;</span><span class="p">,</span> <span class="s1">&#39;adam smith&#39;</span><span class="p">,</span> <span class="s1">&#39;elinor ostrom&#39;</span><span class="p">,</span> <span class="s1">&#39;grace hopper&#39;</span><span class="p">,</span> <span class="s1">&#39;jean bartik&#39;</span><span class="p">],</span> <span class="s1">&#39;tags&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;uk; cs&#39;</span><span class="p">,</span> <span class="s1">&#39;uk; econ&#39;</span><span class="p">,</span> <span class="s1">&#39;usa; econ&#39;</span><span class="p">,</span> <span class="s1">&#39;usa; cs&#39;</span><span class="p">,</span> <span class="s1">&#39;usa; cs&#39;</span><span class="p">]})</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>names</th>
      <th>tags</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>ada lovelace</td>
      <td>uk; cs</td>
    </tr>
    <tr>
      <th>1</th>
      <td>adam smith</td>
      <td>uk; econ</td>
    </tr>
    <tr>
      <th>2</th>
      <td>elinor ostrom</td>
      <td>usa; econ</td>
    </tr>
    <tr>
      <th>3</th>
      <td>grace hopper</td>
      <td>usa; cs</td>
    </tr>
    <tr>
      <th>4</th>
      <td>jean bartik</td>
      <td>usa; cs</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>If we now use <code class="docutils literal notranslate"><span class="pre">str.get_dummies</span></code> and split on <code class="docutils literal notranslate"><span class="pre">;</span></code> we can get a dataframe of dummies.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;tags&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="s1">&#39;;&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>cs</th>
      <th>econ</th>
      <th>uk</th>
      <th>usa</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="reading-text-in">
<h2><span class="section-number">1.6. </span>Reading Text In<a class="headerlink" href="#reading-text-in" title="Permalink to this headline">¶</a></h2>
<div class="section" id="text-file">
<h3><span class="section-number">1.6.1. </span>Text file<a class="headerlink" href="#text-file" title="Permalink to this headline">¶</a></h3>
<p>If you have just a plain text file, you can read it in like so:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">fname</span> <span class="o">=</span> <span class="s1">&#39;book.txt&#39;</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">text_of_book</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</pre></div>
</div>
<p>You can also read a text file directly into a <strong>pandas</strong> dataframe using</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;book.txt&#39;</span><span class="p">,</span> <span class="n">delimiter</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>In the above, the delimiter for different rows of the dataframe is set as “\n”, which means new line, but you could use whatever delimiter you prefer.</p>
<div class="admonition-exercise admonition">
<p class="admonition-title">Exercise</p>
<p>Download the file ‘smith_won.txt’ from this book’s github repository using this <a class="reference external" href="https://github.com/aeturrell/coding-for-economists/blob/main/data/smith_won.txt">link</a> (use right-click and save as). Then read the text in using <strong>pandas</strong>.</p>
</div>
</div>
<div class="section" id="csv-file">
<h3><span class="section-number">1.6.2. </span>CSV file<a class="headerlink" href="#csv-file" title="Permalink to this headline">¶</a></h3>
<p>CSV files are already split into rows. By far the easiest way to read in csv files is using <strong>pandas</strong>,</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;book.csv&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Remember that <strong>pandas</strong> can read many other file types too.</p>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "codeforecon"
        },
        kernelOptions: {
            kernelName: "codeforecon",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'codeforecon'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="econmt-regression.html" title="previous page"><span class="section-number">3. </span>Regression</a>
    <a class='right-next' id="next-link" href="text-nlp.html" title="next page"><span class="section-number">2. </span>Natural Language Processing</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Arthur Turrell<br/>
        
            &copy; Copyright 2020.<br/>
          <div class="extra_footer">
            This book is available under an MIT license.
          </div>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="_static/js/index.d3f166471bb80abb5163.js"></script>


    
    <!-- Google Analytics -->
    <script>
      window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
      ga('create', 'UA-189705534-1', 'auto');
      ga('set', 'anonymizeIp', true);
      ga('send', 'pageview');
    </script>
    <script async src='https://www.google-analytics.com/analytics.js'></script>
    <!-- End Google Analytics -->
    
  </body>
</html>